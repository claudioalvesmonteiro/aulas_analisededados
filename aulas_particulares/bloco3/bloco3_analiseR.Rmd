---
title: Análise de Dados em R - Bloco 3
author: Cláudio A. Monteiro
date: Maio, 2018
output:
   rmdformats::readthedown:
    highlight: kate
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Teste de Qui-quadrado

Para executar o teste de qui-quadrado, baixe e carregue o banco de dados "treat_improve.csv" disponível [neste repositório](https://github.com/claudioalvesmonteiro/aulas_analisededados/tree/master/aulas_particulares/dados). No banco constam os casos de um experimento hipotético em que se encontram as informações do grupo de tratamento e o grupo de controle, que recebram uma droga para melhorar desempenho cognitivo e se os indíviduos apresentaram uma melhora ou não após a aplicação da droga.

```{r, echo=FALSE, results='hide',message=FALSE}
library(readr)
quiData <- read_csv("/home/pacha/Documents/git_projects/aulas_analisededados/aulas_particulares/dados/treat_improve.csv")
```

```{r}
# visualizar estrutura
str(quiData)

# visualizar contagem dos grupos
table(quiData$treatment, quiData$improvement)
```
```{r}
# executar teste de qui-quadrado
chisq.test(quiData$treatment, quiData$improvement, correct=FALSE)
```

# Teste T 

## Amostras Independente

Importe o banco de dados "Pokemon.csv", localizado no mesmo repositório, para carregar informacoes sobre os pokémons e executarmos o teste T.

```{r, echo=FALSE, results='hide',message=FALSE}
library(readr)
Pokemon <- read_csv("/home/pacha/Documents/git_projects/aulas_analisededados/aulas_particulares/dados/Pokemon.csv")
```

Você viu nas aulas passadas como criar um histograma com o pacote ggplot2. No seu Script execute o código para gerar um gráfico como esse abaixo:

```{r, echo=FALSE}
# ggplot histograma
library(ggplot2)
ggplot(data = Pokemon, aes(x = Pokemon$Total))+
  geom_histogram()
```

Abaixo segue um gráfico de densidade, que assim como o histograma, mostra a distribuição da variável.

```{r}
# ggplot densidade
ggplot(data = Pokemon, aes(x = Pokemon$Total))+
  geom_density()
```

```{r}
# executar teste T
t.test(Pokemon$Total~Pokemon$Legendary)
```

## Amostras Emparelhadas

Para executar o teste T para amostras emparelhadas vamos importar um banco de dados com os pesos de ratos antes e depois de se alimentarem com uma nova ração.

```{r, echo=FALSE, results='hide',message=FALSE}
meusRatos <- read_csv("/home/pacha/Documents/git_projects/aulas_analisededados/aulas_particulares/dados/ratosData.csv")
```

```{r}
# visualizar estrutura do banco
str(meusRatos)
```

```{r}
# executar teste t para amostras emparelhadas
teste <- t.test(peso ~ grupo, data = meusRatos, paired = TRUE)
teste
```

# ANOVA

## One Way

Para comparar as médias entre dois grupos ou mais utilizamos o teste ANOVA, nesse temos apenas uma variavel categórica na análise então usamos One Way ANOVA. Para executar este teste vamos utilizar novamente a base de dados de Pokemóns.

Primeiramente vamos visualizar as estatísticas descritivas de cada grupo, dada uma determinada variável, a partir do gráfico de caixa (boxplot):

```{r}
# visualizar boxplot por grupo
ggplot(data = Pokemon, aes(x=Pokemon$Type1, y=Pokemon$Total)) +
  geom_boxplot(aes(fill=Pokemon$Type1))
```

```{r}
# executar e visualizar modelo ANOVA
fit <- aov(Total ~ Type1, data=Pokemon) 
summary(fit)
```

Podemos também executar o teste Tukey Honest Significant Differences para testar diferencas entre cada um dps grupos:

```{r}
# executar e visualizar o teste Tukey HSD
x <- TukeyHSD(fit, conf.level = 0.95)
x
```

Podemos ainda selecionar apenas as comparacoes que apresentam resultados significativos, a um p-valor menor que 0.05:

```{r}
datap <- data.frame(x$Type1)
datacomp<-  datap[datap$p.adj < 0.05,]
datacomp
```

## Two Way

Para executar o teste Two Way ANOVA vamos trabalhar com o banco hipotético "sheepData.csv", com dados do sexo, tipo genético e desempenho sexual das ovelhas.

```{r}
ovelhasData<- read_csv("/home/pacha/Documents/git_projects/aulas_analisededados/aulas_particulares/dados/sheepData.csv")
```

```{r}
str(ovelhasData)
```

```{r}
# executar e visualizar two way ANOVA
res.aov2 <- aov(Sexual_Activity ~ Sex + Genotype, data = ovelhasData)
summary(res.aov2)
```

# Extra

Um pacote interessante desenvolvido para o R é pacote *viridis* que define algumas paletas de cores mais interessantes para visualização gráfica. Instale e carregue esse pacote para reproduzir o gráfico de múltiplos boxplots.

```{r}
# carregar pacote
library(viridis)

# visualizar boxplot por grupo e definir preechimento com viridis
ggplot(data = Pokemon, aes(x=Pokemon$Type1, y=Pokemon$Total)) +
  geom_boxplot(aes(fill=Pokemon$Type1))+
  scale_fill_viridis(discrete = TRUE)

# visualizar documentacao da funcao
?scale_fill_viridis
```




